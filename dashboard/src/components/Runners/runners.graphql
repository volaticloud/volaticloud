# List query - no secrets, safe for public runners
query GetRunners($first: Int, $after: Cursor, $where: BotRunnerWhereInput) {
  botRunners(first: $first, after: $after, where: $where) {
    edges {
      node {
        id
        name
        type
        ownerID
        public
        createdAt
        dataIsReady
        dataLastUpdated
        dataDownloadStatus
        dataDownloadProgress
        dataErrorMessage
        billingEnabled
        bots {
          totalCount
        }
      }
    }
    pageInfo {
      hasNextPage
      hasPreviousPage
      startCursor
      endCursor
    }
    totalCount
  }
}

# Detail query with secrets - for owner's edit dialog
query GetRunnerWithSecrets($id: ID!) {
  botRunners(where: { id: $id }) {
    edges {
      node {
        id
        name
        type
        config
        s3Config
        s3DataKey
        s3DataUploadedAt
        createdAt
        dataIsReady
        dataLastUpdated
        dataDownloadStatus
        dataDownloadProgress
        dataDownloadConfig
        dataErrorMessage
        billingEnabled
        cpuPricePerCoreHour
        memoryPricePerGBHour
        networkPricePerGB
        storagePricePerGB
        bots {
          totalCount
        }
      }
    }
  }
}

mutation CreateRunner($input: CreateBotRunnerInput!) {
  createBotRunner(input: $input) {
    id
    name
    type
    config
    dataDownloadConfig
    billingEnabled
    cpuPricePerCoreHour
    memoryPricePerGBHour
    networkPricePerGB
    storagePricePerGB
  }
}

mutation UpdateRunner($id: ID!, $input: UpdateBotRunnerInput!) {
  updateBotRunner(id: $id, input: $input) {
    id
    name
    type
    config
    dataDownloadConfig
    billingEnabled
    cpuPricePerCoreHour
    memoryPricePerGBHour
    networkPricePerGB
    storagePricePerGB
  }
}

mutation DeleteRunner($id: ID!) {
  deleteBotRunner(id: $id)
}

mutation RefreshRunnerData($id: ID!) {
  refreshRunnerData(id: $id) {
    id
    name
    type
    dataIsReady
    dataLastUpdated
    dataDownloadStatus
    dataDownloadProgress
    dataErrorMessage
  }
}

mutation TestRunnerConnection($type: BotRunnerRunnerType!, $config: RunnerConfigInput!) {
  testRunnerConnection(type: $type, config: $config) {
    success
    message
    version
  }
}

mutation SetRunnerVisibility($id: ID!, $public: Boolean!) {
  setRunnerVisibility(id: $id, public: $public) {
    id
    name
    public
  }
}

mutation TestS3Connection($config: S3ConfigInput!) {
  testS3Connection(config: $config) {
    success
    message
  }
}

# Subscribe to runner status changes (detail view)
subscription RunnerStatusChanged($runnerId: ID!) {
  runnerStatusChanged(runnerId: $runnerId) {
    id
    name
    type
    dataIsReady
    dataLastUpdated
    dataDownloadStatus
    dataDownloadProgress
    dataErrorMessage
  }
}

# Subscribe to all runner changes in an organization (list view)
subscription RunnerChanged($ownerId: String!) {
  runnerChanged(ownerId: $ownerId) {
    id
    name
    type
    dataIsReady
    dataLastUpdated
    dataDownloadStatus
    dataDownloadProgress
    dataErrorMessage
    bots {
      totalCount
    }
  }
}